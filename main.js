(()=>{"use strict";const e=JSON.parse('[{"flavour":"с фуа-гра","label":"Сказочное заморское яство","inStock":1,"weight":"0,5","feature":["10 порций","мышь в подарок"],"call":"Печень утки разварная с артишоками."},{"flavour":"с рыбой","label":"Сказочное заморское яство","inStock":1,"weight":"2","feature":["40 порций","2 мыши в подарок"],"call":"Головы щучьи с чесноком да свежайшая сёмгушка."},{"flavour":"с курой","label":"Сказочное заморское яство","inStock":0,"weight":"5","feature":["100 порций","5 мышей в подарок","заказчик доволен"],"call":"Филе из цыплят с трюфелями в бульоне."}]');function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}var l=function(){function a(){var e;t(this,a),this.elem=null!==(e=document.querySelector(".catalog"))&&void 0!==e?e:document.body,this.products=[]}return i(a,[{key:"init",value:function(){var t=this;if(!e)throw new Error("No database of products");this.clear(),e.forEach((function(e){var a=new c(e.flavour,e.label,e.inStock,e.weight,e.call,e.feature),i=document.createElement("li");i.classList.add("card","catalog__card"),i.append(a.create()),i.append(a.call),t.products.push(i)})),this.addCards()}},{key:"addCards",value:function(){var e=this;this.products.forEach((function(t){e.elem.append(t)}))}},{key:"clear",value:function(){if(!this.elem.querySelector("li"))throw new Error("Nothing delete");this.elem.querySelectorAll("li").forEach((function(e){return e.remove()}))}}]),a}(),c=function(){function e(a,i,l,c,s,n){t(this,e),this.flavour=a,this.labelText=i,this.weight=c.toString(),this.feature=null!=n?n:"",this.inStock=l,this.callText=s,this.article=document.createElement("article"),this.call=document.createElement("p"),this.label=document.createElement("blockquote"),this.isSelect=!1,this.isDisable()}return i(e,[{key:"create",value:function(){this.article.classList.add("pack","card__pack"),this.call.classList.add("call","card__call"),this.label.classList.add("pack__label"),this.label.innerText=this.labelText;var e=this.feature;return this.article.innerHTML='\n      <h3 class="pack__name">Нямушка <span class="pack__flavour">'.concat(this.flavour,"</span></h3>\n      ").concat(function(){if(""===e)return"";var t=['<ul class="feature pack__feature">\n'];return e.forEach((function(e){var a=e.split(" ").map((function(e){return isNaN(+e)?e:'<span class="feature__num">'.concat(e,"</span>")}));t.push('<li class="feature__item">'.concat(a.join(" "),"</li>\n"))})),t.push("</ul>"),t.join("")}(),'\n      <p class="weight pack__weight">\n        <span class="weight__value">').concat(this.weight,'</span>кг\n      </p>\n      <div class="pack__image">\n        <img src="img/pack/cat.png" alt="Фото послушного котика, который любит нямушку" class="pack__img">\n      </div>'),this.article.querySelector("h3").after(this.label),this.call.innerHTML='Чего сидишь? Порадуй котэ, <button class="call__btn">купи.</button>',this.inStock<=0&&this.changeCall("Печалька, ".concat(this.flavour," закончился.")),this.article}},{key:"select",value:function(){this.article.classList.contains("pack_selected")?this.resetSelect():(this.article.classList.add("pack_selected"),this.changeCall(this.callText),this.isSelect=!0)}},{key:"isDisable",value:function(){this.inStock<=0?this.article.classList.add("pack_disabled"):this.events()}},{key:"resetSelect",value:function(){this.article.classList.remove("pack_selected"),this.article.classList.contains("pack_selected-hover")&&this.article.classList.remove("pack_selected-hover"),this.changeCall(),this.isSelect=!1,this.isMouseLeave=!1,this.changeLabel()}},{key:"changeCall",value:function(e){e?this.call.innerText=e:this.call.innerHTML='Чего сидишь? Порадуй котэ, <button class="call__btn">купи.</button>'}},{key:"changeLabel",value:function(e){this.label.innerText=e?"Котэ не одобряет?":this.labelText}},{key:"events",value:function(){var e=this;this.article.addEventListener("click",(function(t){e.select()})),this.call.addEventListener("click",(function(t){t.target.closest("button")&&e.select()})),this.article.addEventListener("mouseleave",(function(t){if(e.isSelect)return e.article.classList.add("pack_selected-hover"),void e.changeLabel(!0)})),this.article.addEventListener("mouseenter",(function(t){if(e.isSelect)return e.article.classList.remove("pack_selected-hover"),void e.changeLabel()}))}}]),e}();(new l).init()})();